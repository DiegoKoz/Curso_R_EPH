{
    "collab_server" : "",
    "contents" : "#Reinciar R\nlibrary(tidyverse, warn = FALSE)\nlibrary(openxlsx, warn = FALSE)\n\n###Selecciono variables\nvar.ind <- c('CODUSU','NRO_HOGAR' ,'COMPONENTE','ANO4','TRIMESTRE','REGION',\n             'AGLOMERADO', 'PONDERA', 'CH04', 'CH06', 'ITF', 'PONDIH','P21')\n\n###Levanto Bases y otros archivos necesarios\nindividual.316 <- read.table(\"Fuentes/usu_individual_t316.txt\", sep=\";\", dec=\",\", header = TRUE, fill = TRUE) %>% \n  select(var.ind)\nindividual.416 <- read.table(\"Fuentes/usu_individual_t416.txt\", sep=\";\", dec=\",\", header = TRUE, fill = TRUE) %>% \n  select(var.ind)\n\nBases <- bind_rows(individual.316,individual.416)\n\n\nAdequi <- read.xlsx(\"Fuentes/ADEQUI.xlsx\")\nCBA    <- read.xlsx(\"Fuentes/CANASTAS.xlsx\",sheet = \"CBA\")\nCBT    <- read.xlsx(\"Fuentes/CANASTAS.xlsx\",sheet = \"CBT\")\ndic.regiones <- read.xlsx(\"Fuentes/Regiones.xlsx\")\n\n\n## Calculamos Canastas Trimestrales por Regi칩n\nCBA <- CBA %>% \n  mutate(Canasta = 'CBA')\n\nCBT <- CBT %>% \n  mutate(Canasta = 'CBT')\n\nCanastas_Reg <- bind_rows(CBA,CBT)                       %>% \n  gather(.,Region, Valor, c(3:(ncol(.)-1) ))             %>%\n  mutate(Trimestre = case_when(Mes %in% c(1:3)   ~1,\n                               Mes %in% c(4:6)   ~2,\n                               Mes %in% c(7:9)   ~3,\n                               Mes %in% c(10:12) ~4),\n         Periodo = paste(A침o, Trimestre, sep='.'))      \n\nCanastas_Reg_2 <- Canastas_Reg %>% \n  group_by(Canasta, Region, Periodo)                     %>% \n  summarise(Valor = mean(Valor))                         %>% \n  spread(., Canasta,Valor)                               %>% \n  left_join(., dic.regiones, by = \"Region\")              %>% \n  ungroup()                                              \n\n\n###Aplicamos sucesivos pasos para el calculo de Poberza e Indigencia por Periodo y Region\nPobreza_Individual <- Bases %>% \n  mutate(Periodo = paste(ANO4, TRIMESTRE, sep='.')) %>% \n  left_join(., Adequi, by = c(\"CH04\", \"CH06\")) %>% \n  left_join(., Canastas_Reg_2, by = c(\"REGION\", \"Periodo\"))    \n\n\nPobreza_Individual_paso2 <- Pobreza_Individual %>%  \n  group_by(CODUSU, NRO_HOGAR, Periodo)                          %>% \n  mutate(Adequi_hogar = sum(adequi))                            %>%\n  ungroup()                                                      \n\nPobreza_Individual_paso3 <-  Pobreza_Individual_paso2 %>% \n mutate(CBA = CBA*Adequi_hogar,\n        CBT = CBT*Adequi_hogar,\n        Situacion = case_when(ITF<CBA            ~ 'Indigente',\n                               ITF>=CBA & ITF<CBT ~ 'Pobre',\n                               ITF>=CBT           ~ 'No.Pobre'))  \n\n##C치lculo de Tasas de Pobreza e Indigencia por Sexo\n\nPobreza_resumen <- Pobreza_Individual_paso3 %>% \n  group_by(Periodo,CH04) %>% \n  summarise(Tasa_pobreza    = sum(PONDIH[Situacion %in% c('Pobre', 'Indigente')],na.rm = TRUE)/\n                              sum(PONDIH,na.rm = TRUE),\n            \n            Tasa_indigencia = sum(PONDIH[Situacion == 'Indigente'],na.rm = TRUE)/\n                              sum(PONDIH,na.rm = TRUE)) %>% \n  mutate(Sexo = case_when(CH04==1~\"Varones\",\n                          CH04==2~\"Mujeres\"))\n\n##C치lculo de Tasas de Pobreza por Hogares. Nacional y Regional\nPobreza_Hogares_paso_1 <- Pobreza_Individual_paso3 %>% \n  group_by(Periodo,CODUSU,NRO_HOGAR) %>% \n  summarise(Situacion = unique(Situacion),\n            PONDIH = unique(PONDIH),\n            Region = unique(Region))\n\nPobreza_Hogares_Nac <- Pobreza_Hogares_paso_1 %>% \n  group_by(Periodo) %>% \n  summarise(Tasa_pobreza    = sum(PONDIH[Situacion %in% c('Pobre', 'Indigente')],na.rm = TRUE)/\n                              sum(PONDIH,na.rm = TRUE),\n            \n            Tasa_indigencia = sum(PONDIH[Situacion == 'Indigente'],na.rm = TRUE)/\n                              sum(PONDIH,na.rm = TRUE)) \n\nPobreza_Hogares_Reg <- Pobreza_Hogares_paso_1 %>% \n  group_by(Periodo,Region) %>% \n  summarise(Tasa_pobreza    = sum(PONDIH[Situacion %in% c('Pobre', 'Indigente')],na.rm = TRUE)/\n              sum(PONDIH,na.rm = TRUE),\n            \n            Tasa_indigencia = sum(PONDIH[Situacion == 'Indigente'],na.rm = TRUE)/\n              sum(PONDIH,na.rm = TRUE)) \n",
    "created" : 1538746673472.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "8452360",
    "id" : "FFBD69C2",
    "lastKnownWriteTime" : 1537115678,
    "last_content_update" : 1537115678,
    "path" : "C:/Users/gweks/Desktop/Paquetes/Carpeta del Curso R-CEPED-INDEC/Ejercicios de Clase/Ejercicios - Clase 3.R",
    "project_path" : "Ejercicios de Clase/Ejercicios - Clase 3.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}